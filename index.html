<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Khizanatul 'Ilm - Platform untuk berbagi pengetahuan, kajian, dan wawasan yang bermakna.">
    <meta name="keywords" content="khizanatul ilm, khizanah ilmu, berbagi pengetahuan, kajian, ulasan, wawasan">
    <meta name="theme-color" content="#1e4d40">

    <title>Khizanatul 'Ilm - Platform Pengetahuan</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="ns-logo.png">


    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles with cache busting -->
    <link rel="stylesheet" href="styles.css?v=2.0">
    <link rel="stylesheet" href="settings-styles.css?v=2.0">
    <link rel="stylesheet" href="manage-materials-styles.css?v=2.0">
    <link rel="stylesheet" href="expertise-switcher-styles.css?v=2.0">
    <link rel="stylesheet" href="material-modal-styles.css?v=2.0">
    <link rel="stylesheet" href="material-detail-styles.css?v=2.0">
    <link rel="stylesheet" href="fab-styles.css?v=2.0">
    <!-- Flatpickr for localized date picking -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>

<body>
    <!-- Header with Login -->
    <header class="header">
        <div class="header-content">
            <div class="logo-container">
                <img src="ns-logo.png" alt="Nongkrong SEHAT Logo" class="ns-logo-img">
                <span class="app-name">Khizanatul 'Ilm</span>
            </div>
            <button class="btn-login" id="btnLogin" aria-label="Login">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="main" id="mainContent">
        <!-- Beranda/Pengetahuan Page -->
        <section class="page active" id="pageMateri" role="region" aria-label="Halaman Pengetahuan">
            <div class="container">
                <div class="page-header">
                    <h2 class="page-title">Khizanah Pengetahuan</h2>
                    <p class="page-subtitle">Ruang berbagi wawasan & inspirasi</p>
                </div>

                <div class="presenters-list" id="presentersList">
                    <!-- Presenters akan di-render oleh JavaScript -->
                </div>
            </div>
        </section>

        <!-- Presenter Detail Page -->
        <section class="page" id="pagePresenterDetail" role="region" aria-label="Detail Penyaji">
            <div class="container">
                <button class="btn-back" id="btnBack">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Kembali
                </button>

                <div class="presenter-header" id="presenterHeader">
                    <!-- Header akan di-render oleh JavaScript -->
                </div>

                <!-- Edit Mode Toggle (Admin Only) -->
                <div id="editModeToggleContainer" class="edit-mode-toggle-container" style="display: none;">
                    <label class="edit-mode-toggle">
                        <input type="checkbox" id="editModeToggle" checked>
                        <span class="toggle-label">Mode Edit</span>
                    </label>
                </div>

                <div class="materials-list" id="materialsList">
                    <!-- Materials akan di-render oleh JavaScript -->
                </div>

                <!-- Floating Action Button (Admin Only) -->
                <button id="fabAddMaterial" class="fab" style="display: none;" title="Tambah ke Arsip">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
            </div>
        </section>

        <!-- Pengetahuan Detail Page -->
        <section class="page" id="pageMaterialDetail" role="region" aria-label="Detail Pengetahuan">
            <div class="container">
                <button class="btn-back" id="btnBackFromMaterial">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Kembali
                </button>

                <div id="materialDetailContent">
                    <!-- Material detail akan di-render oleh JavaScript -->
                </div>
            </div>
        </section>

        <!-- Jadwal Page -->
        <section class="page" id="pageSchedule" role="region" aria-label="Jadwal Kegiatan">
            <div class="container">
                <div class="page-header">
                    <h2 class="page-title">Jadwal Kegiatan</h2>
                    <p class="page-subtitle">Aktivitas komunitas mendatang</p>
                </div>

                <div class="schedule-list" id="scheduleList">
                    <!-- Schedule akan di-render oleh JavaScript -->
                </div>

                <!-- Floating Action Button for Schedule (Admin Only) -->
                <button id="fabAddSchedule" class="fab admin-only-btn" style="display: none;" title="Tambah Jadwal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </button>
            </div>
        </section>

        <!-- Tentang Page -->
        <section class="page" id="pageTentang" role="region" aria-label="Halaman Tentang Kami">
            <div class="container">
                <div class="page-header">
                    <h2 class="page-title">Tentang Kami</h2>
                </div>

                <div class="about-content">
                    <!-- Intro Card -->
                    <div class="about-card main-intro">
                        <h3>Tentang Kami</h3>
                        <p>Nongkrong SEHAT adalah wadah kolaboratif yang didedikasikan untuk membangun khazanah
                            pengetahuan masyarakat. Melalui platform Khazanatul 'Ilm, kami berupaya mengintegrasikan
                            nilai-nilai intelektualitas, emosionalitas, dan spiritualitas dalam setiap diskusi,
                            menciptakan ruang di mana setiap individu dapat berkontribusi dengan keahlian terbaiknya.
                        </p>
                    </div>

                    <!-- Vision & Mission Grid -->
                    <div class="about-card">
                        <h3>Visi & Misi</h3>
                        <div class="vision-mission-grid">
                            <!-- Item 1 -->
                            <div class="vm-item">
                                <div class="vm-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                                        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                                    </svg>
                                </div>
                                <div class="vm-title">Mencerdaskan Kehidupan Berbangsa</div>
                                <ul class="vm-list">
                                    <li>cerdas spiritual</li>
                                    <li>cerdas emosional</li>
                                    <li>cerdas intelektual</li>
                                </ul>
                            </div>

                            <!-- Item 2 -->
                            <div class="vm-item">
                                <div class="vm-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="9" cy="7" r="4"></circle>
                                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                    </svg>
                                </div>
                                <div class="vm-title">Keahlian & Peran Terbaik</div>
                                <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.5; margin: 0;">
                                    Setiap orang dengan ahli dibidang dan peran terbaiknya.</p>
                            </div>

                            <!-- Item 3 -->
                            <div class="vm-item">
                                <div class="vm-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                    </svg>
                                </div>
                                <div class="vm-title">Landasan Keyakinan</div>
                                <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.5; margin: 0;">
                                    Islam sebagai cara berfikir berkeyakinan dan bertindak.</p>
                            </div>

                            <!-- Item 4 -->
                            <div class="vm-item">
                                <div class="vm-icon">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                                    </svg>
                                </div>
                                <div class="vm-title">Intelektualitas Mandiri</div>
                                <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.5; margin: 0;">
                                    Memberantas Taqlid buta dalam berkeyakinan.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Community Links Card -->
                    <div class="about-card">
                        <h3>Bergabung dengan Komunitas</h3>
                        <p>Dapatkan wawasan baru dan jalin diskusi harian yang bermakna melalui ruang resmi kami!</p>

                        <div class="social-links-grid">
                            <!-- WhatsApp Community -->
                            <a href="#" class="social-link-item" target="_blank" rel="noopener">
                                <div class="social-icon whatsapp">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path
                                            d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 1 1-7.6-11.2h.1A8.2 8.2 0 0 1 21 11.5Z">
                                        </path>
                                        <path d="M12 7v10"></path>
                                        <path d="M8 12h8"></path>
                                    </svg>
                                </div>
                                <span class="social-label">WhatsApp</span>
                            </a>

                            <!-- Instagram -->
                            <a href="#" class="social-link-item" target="_blank" rel="noopener">
                                <div class="social-icon instagram">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                                        <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                                        <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                                    </svg>
                                </div>
                                <span class="social-label">Instagram</span>
                            </a>

                            <!-- TikTok -->
                            <a href="#" class="social-link-item" target="_blank" rel="noopener">
                                <div class="social-icon tiktok">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M9 12a4 4 0 1 0 4 4V4a5 5 0 0 0 5 5"></path>
                                    </svg>
                                </div>
                                <span class="social-label">TikTok</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Page (Admin Only) -->
        <section class="page" id="pageSettings" role="region" aria-label="Pengaturan">
            <div class="container">
                <div class="page-header">
                    <h2 class="page-title">Pengaturan</h2>
                    <p class="page-subtitle">Kelola bidang keahlian penyaji</p>
                </div>

                <div class="settings-content">
                    <!-- Preview Mode Toggle -->
                    <div class="settings-card mode-toggle-card">
                        <div class="mode-toggle-header">
                            <div class="mode-info">
                                <h3>ğŸ‘€ Pantau sebagai User</h3>
                                <p class="settings-description">Sembunyikan semua tombol admin untuk melihat tampilan
                                    sebagai pengunjung biasa.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="userViewToggle">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>

                    <div class="settings-card">
                        <h3>â˜ï¸ Sinkronisasi Data Cloud</h3>
                        <p class="settings-description">Unggah data lokal Anda ke database pusat (Supabase) jika Vercel
                            belum update.</p>
                        <button class="btn-save-expertise" id="btnSyncLocalToCloud"
                            style="background: var(--primary-accent); margin-top: 10px;">
                            ğŸ“¤ Unggah Data Lokal ke Cloud
                        </button>
                    </div>

                    <div class="settings-card">
                        <h3>ğŸ‘¥ Bidang Keahlian Penyaji</h3>
                        <p class="settings-description">Atur bidang keahlian untuk setiap penyaji di bawah ini.</p>

                        <div class="expertise-list" id="expertiseList">
                            <!-- Will be rendered by JavaScript -->
                        </div>

                        <button class="btn-save-expertise" id="btnSaveExpertise">
                            ğŸ’¾ Simpan Perubahan
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation (Mobile-First) -->
    <nav class="bottom-nav" role="navigation" aria-label="Navigasi Utama">
        <button class="nav-item active" data-page="pageMateri" aria-label="Pengetahuan" aria-current="page">
            <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            <span class="nav-label">Pengetahuan</span>
        </button>

        <button class="nav-item" data-page="pageSchedule" aria-label="Jadwal Kegiatan">
            <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
            <span class="nav-label">Kegiatan</span>
        </button>

        <button class="nav-item" data-page="pageTentang" aria-label="Tentang Kami">
            <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 16v-4"></path>
                <path d="M12 8h.01"></path>
            </svg>
            <span class="nav-label">Tentang</span>
        </button>

        <!-- Admin Only: Settings -->
        <button class="nav-item nav-admin-only" data-page="pageSettings" aria-label="Pengaturan" style="display: none;">
            <svg class="nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6m-6-6H1m6 0h6m6 0h5"></path>
            </svg>
            <span class="nav-label">Pengaturan</span>
        </button>
    </nav>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="btn-close-modal" id="btnCloseModal" aria-label="Close">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>

            <h2 class="modal-title">Login Admin</h2>
            <p class="modal-description">Masuk untuk mengelola konten</p>

            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required autocomplete="current-password">
                </div>
                <button type="submit" class="btn-submit">Login</button>
            </form>
        </div>
    </div>

    <!-- Material Management Modal -->
    <div class="modal" id="materialModal">
        <div class="modal-content">
            <button class="btn-close-modal" id="btnCloseMaterialModal" aria-label="Close">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>

            <h2 class="modal-title" id="materialModalTitle">Tambah ke Arsip</h2>
            <p class="modal-description" id="materialModalDescription">Tambahkan pengetahuan baru untuk diarsipkan
            </p>

            <form id="materialForm" class="material-form">
                <input type="hidden" id="materialId">
                <input type="hidden" id="materialPresenterId">
                <input type="hidden" id="materialExpertiseIndex">

                <div class="form-group">
                    <label for="materialTitle">Judul Pengetahuan *</label>
                    <input type="text" id="materialTitle" name="title" required
                        placeholder="Masukkan judul pengetahuan...">
                </div>

                <div class="form-group">
                    <label for="materialCategory">Kategori *</label>
                    <input type="text" id="materialCategory" name="category" required
                        placeholder="Contoh: Kesehatan Mental">
                </div>

                <div class="form-group">
                    <label for="materialDate">Tanggal *</label>
                    <input type="date" id="materialDate" name="date" required>
                </div>

                <div class="form-group">
                    <label for="materialContent">Isi Pengetahuan *</label>
                    <textarea id="materialContent" name="content" required
                        placeholder="Tulis isi pengetahuan di sini..." rows="8"></textarea>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-cancel" id="btnCancelMaterial">Batal</button>
                    <button type="submit" class="btn-submit">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Schedule Modal -->
    <div id="scheduleModal" class="modal" role="dialog" aria-labelledby="scheduleModalTitle" aria-modal="true">
        <div class="modal-overlay" id="scheduleModalOverlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="scheduleModalTitle">Manajemen Jadwal</h3>
                <button class="btn-close-modal" id="btnCloseScheduleModal" aria-label="Tutup modal">
                    &times;
                </button>
            </div>
            <form id="scheduleForm" class="material-form">
                <input type="hidden" id="scheduleId">
                <div class="form-group">
                    <label for="scheduleDate">Hari / Keterangan</label>
                    <div class="quick-selectors" id="hariSelectors">
                        <button type="button" class="btn-quick-time" data-value="Menunggu Waktu Luang">Menunggu Waktu
                            Luang</button>
                        <button type="button" class="btn-quick-time presentasi-only-time"
                            data-value="Malam Minggu Ini">Malam Minggu Ini</button>
                        <button type="button" class="btn-quick-time presentasi-only-time"
                            data-value="Malam Minggu Selanjutnya">Malam Minggu Selanjutnya</button>
                    </div>
                    <input type="hidden" id="scheduleDate" value="Menunggu Waktu Luang" required>
                </div>
                <div class="form-group">
                    <label for="scheduleTime">Pukul / Jam</label>
                    <!-- Quick Time Presets -->
                    <div class="time-quick-buttons">
                        <button type="button" class="btn-time-preset" data-time="Ba'da Isya">Ba'da Isya</button>
                        <button type="button" class="btn-time-preset" data-time="Siang">Siang</button>
                        <button type="button" class="btn-time-preset" data-time="14:00">14:00</button>
                        <button type="button" class="btn-time-preset" data-time="21:00">21:00</button>
                    </div>
                    <!-- Single Flexible Input -->
                    <input type="text" id="scheduleTime"
                        placeholder="Atau ketik waktu custom, misal: 21:00 atau Ba'da Subuh">
                </div>
                <input type="hidden" id="scheduleOrder" value="1">
                <div class="form-group">
                    <label for="scheduleTitle">Judul Kegiatan</label>
                    <input type="text" id="scheduleTitle" placeholder="Contoh: Presentasi: Fiqih Ibadah" required>
                </div>
                <div class="form-group">
                    <label for="schedulePresenter">Penyaji</label>
                    <input type="text" id="schedulePresenter" placeholder="Nama penyaji" required>
                </div>
                <div class="form-group">
                    <label for="scheduleType">Kategori</label>
                    <select id="scheduleType" required>
                        <option value="Presentasi">Presentasi</option>
                        <option value="Jalsah Mudzakarah">Jalsah Mudzakarah</option>
                        <option value="Mudzakarah Santri">Mudzakarah Santri</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="scheduleLocation">Lokasi / Link Meet</label>
                    <input type="text" id="scheduleLocation" placeholder="Contoh: Musholla atau Link Zoom">
                </div>
                <div class="form-group">
                    <label for="scheduleStatus">Status</label>
                    <select id="scheduleStatus" required>
                        <option value="upcoming">Akan Datang</option>
                        <option value="completed">Selesai</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-cancel" id="btnCancelSchedule">Batal</button>
                    <button type="submit" class="btn-submit">Simpan Jadwal</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Flatpickr scripts -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/id.js"></script>

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>

    <!-- Main App Script -->
    <script src="script.js"></script>
</body>

</html>
```